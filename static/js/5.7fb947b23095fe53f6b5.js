webpackJsonp([5],{"1nT4":function(e,t,s){"use strict";var n=s("woOf"),o=s.n(n),i=s("Dd8w"),a=s.n(i),r=s("NYxO"),l={1:{label:"电气",icon:"iconfont icon-jianzhudianqigongcheng",bgClass:"electric-fire"},SmokeDtector:{label:"烟感",icon:"iconfont icon-smoke-detector",bgClass:"smoke-detector"},GasDetectorHome:{label:"家用可燃气报警",icon:"iconfont icon-home-gas-detector",bgClass:"home-gas-detector"},GasDetectorIndu:{label:"工业可燃气体",icon:"iconfont icon-indu-gas-detector",bgClass:"indu-gas-detector"},LiquidLevel:{label:"液位",icon:"iconfont icon-shuiwei",bgClass:"water-level"},WaterPressure:{label:"水压",icon:"iconfont icon-water-press",bgClass:"water-pressure"},Geomagnetic:{label:"地磁",icon:"iconfont icon-geomagnetic",bgClass:"geomagnetic"},Cover:{label:"井盖",icon:"iconfont icon-cover",bgClass:"cover"},WaterMeterSP:{label:"视频采集水表",icon:"iconfont icon-yalichuanganqi",bgClass:"water-meter"},WaterMeterSK:{label:"水表",icon:"iconfont icon-yalichuanganqi",bgClass:"water-meter"},Temp_Humi:{label:"温湿度",icon:"iconfont icon-temp-hum",bgClass:"temp-hum"},Lamp:{label:"路灯",icon:"iconfont icon-streetlamp",bgClass:"lamp"},Flow:{label:"水流",icon:"iconfont icon-yangantanceqi",bgClass:"smoke-detector"}},c={ok:{bgColor:"#f3fff9",tag:{text:"正常",color:"#5edf9b"}},offline:{bgColor:"#edf2ff",tag:{text:"离线",color:"#618ff9"}},error:{bgColor:"#999999",tag:{text:"故障",color:"#666666"}},alarm:{bgColor:"#fff4f4",tag:{text:"报警",color:"#ff5b5b"}}},u={name:"sensors",components:{battery:s("4U5q").a},props:{params:{type:Object,required:!0,default:function(){return{}}}},computed:{sen:function(){var e=l[this.sensor.categoryCode]||{label:"传感器",icon:"iconfont icon-yangantanceqi",bgClass:"smoke-detector"},t=e.label;return{icon:e.icon,title:t,bgClass:e.bgClass}},otherStyles:function(){var e={};return this.sensor.batteries&&this.sensor.batteries.length>0?e.title={showBtry:!0,span:[20,4]}:e.title={showBtry:!1,span:[24,0]},e},statusStyle:function(){var e=this.sensor.statusName;return c[{"正常":"ok","离线":"offline","故障":"error","报警":"alarm"}[e]]}},data:function(){return{loading:!1,sensor:{bottomLeft:"",bottomRight:"",categoryCode:"",categoryName:"",devId:"",statusName:"",title:"",batteries:[],values:[],commands:[]},equipmentDetail:"equipment-detail"}},methods:a()({},Object(r.b)({switchDevice:"monitor/switchDevice"}),{switchDev:function(e){var t=this;this.loading=!0,this.switchDevice({cmd:e.cmd,deveui:e.deveui}).then(function(e){t.loading=!1})}}),watch:{params:{immediate:!0,deep:!0,handler:function(e,t){if(e){var s=e.bottomLeft,n=e.bottomRight,i=e.categoryCode,a=e.categoryName,r=e.devId,l=e.statusName,c=e.title,u=e.batteries,d=e.values,g=e.commands;this.sensor=o()({},this.sensor,{bottomLeft:s,bottomRight:n,categoryCode:i,categoryName:a,devId:r,statusName:l,title:c,batteries:u,values:d,commands:g})}}}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],class:[e.equipmentDetail],style:{"background-color":e.statusStyle.bgColor}},[s("i",{staticClass:"sensor-icon",class:e.sen.icon,attrs:{title:e.sen.title}}),e._v(" "),s("el-row",{staticClass:"location",attrs:{gutter:0,title:e.sensor.title}},[s("el-col",{attrs:{span:e.otherStyles.title.span[0]}},[s("span",[e._v(e._s(e.sensor.title))])]),e._v(" "),e.otherStyles.title.showBtry?s("el-col",{staticClass:"btry",attrs:{span:e.otherStyles.title.span[1]}},e._l(e.sensor.batteries,function(e,t){return s("battery",{key:t,attrs:{value:e.percent,title:e.tip}})})):e._e()],1),e._v(" "),s("el-row",[s("el-col",[s("el-tag",{staticStyle:{color:"#fff","font-size":"1.6667rem","font-family":"Microsoft YaHei"},attrs:{color:e.statusStyle.tag.color}},[e._v(e._s(e.statusStyle.tag.text))])],1)],1),e._v(" "),e.sensor.values.length>0?s("el-row",{style:{"text-align":"center","line-height":"5.7777rem",height:"6.25rem"},attrs:{gutter:0}},e._l(e.sensor.values,function(t,n){return s("el-col",{key:n,staticClass:"data",style:{"font-size":e.sensor.values.length<=2?"5rem":"1.3333rem"},attrs:{span:24/e.sensor.values.length,title:t.tip}},[s("span",{style:{color:e.statusStyle.tag.color,"font-family":"ArialMT"}},[e._v(e._s(2===t.value.toString().split(".").length&&t.value.toString().split(".")[1].length>2?parseFloat(t.value).toFixed(3):t.value))]),e._v(" "),s("span",{staticStyle:{"font-size":"0.6667rem"}},[e._v(e._s(t.unit))])])})):e._e(),e._v(" "),e.sensor.commands.length>0?s("el-row",{staticStyle:{"text-align":"center","line-height":"5.7777rem",height:"6.25rem"},attrs:{gutter:0}},e._l(e.sensor.commands,function(t,n){return s("el-col",{key:n,attrs:{span:24/e.sensor.commands.length,title:t.tip}},[s("el-button",{attrs:{round:"",type:"ON"==t.cmd?"success":"danger",size:"mini"},on:{click:function(s){e.switchDev(t)}}},[e._v(e._s(t.name))])],1)})):e._e(),e._v(" "),s("el-row",{staticStyle:{"text-align":"left","font-size":"1.16667rem"},attrs:{gutter:0}},[s("el-col",{attrs:{span:10,title:"设备编号"}},[e._v(e._s(e.sensor.bottomLeft))]),e._v(" "),s("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12,offset:2,title:"上报时间"}},[e._v(e._s(e.sensor.bottomRight))])],1)],1)},staticRenderFns:[]};var g=s("VU/8")(u,d,!1,function(e){s("7f8e")},"data-v-04be1ed5",null);t.a=g.exports},"3PSS":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("Xxa5"),o=s.n(n),i=s("exGp"),a=s.n(i),r=s("Dd8w"),l=s.n(r),c=s("1nT4"),u={name:"filter",props:{sensorTypes:{type:Array,default:function(){return[]}},sensorStatus:{type:Array,default:function(){return[]}}},computed:{types:function(){return this.sensorTypes.map(function(e){return{code:e.CODE,name:e.NAME}})}},data:function(){return{show:!0,status:[],typeActive:"",statusActive:""}},methods:{toggle:function(){this.show=!this.show},changeSensors:function(e){this.typeActive=e.code,this.$emit("sensorChanged",e)},changeStatus:function(e){var t=e.value;this.statusActive=t,this.$emit("statusChanged",e)},getStyle:function(e,t){return e===this["status"===t?"statusActive":"typeActive"]?"primary":"default"}}},d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"filter"},[s("el-popover",{key:"pop1",attrs:{placement:"bottom",width:"400",trigger:"hover","popper-class":"custom-popover"}},[s("div",{staticClass:"types"},[s("el-button",{attrs:{type:e.getStyle("","type"),size:"mini",round:""},on:{click:function(t){e.changeSensors({code:"",name:"全部"})}}},[e._v("\r\n          全部\r\n        ")]),e._v(" "),e._l(e.types,function(t,n){return s("el-button",{key:n,attrs:{type:e.getStyle(t.code,"type"),size:"mini",round:""},on:{click:function(s){e.changeSensors(t)}}},[e._v("\r\n          "+e._s(t.name)+"\r\n        ")])})],2),e._v(" "),s("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[s("span",[e._v("全部类型")]),s("i",{staticClass:"el-icon-arrow-down"})])])],1),e._v(" "),s("div",{staticClass:"filter",staticStyle:{"margin-left":"2rem"}},[s("el-popover",{key:"pop2",attrs:{placement:"bottom",width:"400",trigger:"hover","popper-class":"custom-popover"}},[s("div",{staticClass:"status"},[s("el-button",{attrs:{type:e.getStyle("","status"),size:"mini",round:""},on:{click:function(t){e.changeStatus({value:"",name:"全部"})}}},[e._v("\r\n          全部\r\n        ")]),e._v(" "),e._l(e.sensorStatus,function(t,n){return s("el-button",{key:n,attrs:{type:e.getStyle(t.value,"status"),size:"mini",round:""},on:{click:function(s){e.changeStatus(t)}}},[e._v("\r\n          "+e._s(t.name)+"\r\n        ")])})],2),e._v(" "),s("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[s("span",[e._v("全部状态")]),s("i",{staticClass:"el-icon-arrow-down"})])])],1)])},staticRenderFns:[]};var g=s("VU/8")(u,d,!1,function(e){s("x45B")},"data-v-a499b5bc",null).exports,f=s("dzN6"),m=s("NYxO"),v={name:"profile",components:{"sensor-component":c.a,"sensor-filter":g,"alarm-status":f.a},computed:l()({},Object(m.c)({device:"monitor/device",userInfo:"common/userInfo",deviceInfo:"monitor/deviceInfo",sensorTypes:"monitor/sensorTypes",sensorStatus:"monitor/sensorStatus"})),data:function(){return{popVisible:!1,intervalId:"",deviceloading:!1,alarmList:[],filterSensorType:"",filterSensorStatus:"",selectedAlarm:{}}},destroyed:function(){console.log("destroyed=====")},mounted:function(){var e=this;console.log("mounted+++++++++"),this.intervalId=window.setInterval(a()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.queryDeviceList();case 2:case"end":return t.stop()}},t,e)})),3e3),this.getSensorTypes(),this.getSensorStatus()},beforeDestroy:function(){window.clearInterval(this.intervalId),this.intervalId=null,this.clearAllData()},beforeRouteLeave:function(e,t,s){window.clearInterval(this.intervalId),this.intervalId=null,this.clearAllData(),s()},methods:l()({},Object(m.b)({getDeviceList:"monitor/getDeviceList",switchDevice:"monitor/switchDevice",configPage:"monitor/configPage",getSensorTypes:"monitor/getSensorTypes",getSensorStatus:"monitor/getSensorStatus"}),Object(m.d)({clearAllData:"monitor/CLRAR_ALL_DATA"}),{queryDeviceList:function(){this.getDeviceList({categoryCode:this.filterSensorType,status:this.filterSensorStatus})},changeSensors:function(e){var t=e.code;this.filterSensorType=t,this.configPage({page_number:1,page_size:this.device.page_size}),this.queryDeviceList()},ChangeStatus:function(e){var t=e.value;this.filterSensorStatus=t,this.configPage({page_number:1,page_size:this.device.page_size}),this.queryDeviceList()},selectAlarm:function(e,t){this.popVisible=!0;var s=e.id,n=e.type,o=e.name,i=e.suggestion,a=e.deviceStatus,r=e.deviceStatusName,l=e.reason,c=e.desc,u=e.categoryCode;this.selectedAlarm={id:s,type:n,name:o,suggestion:i,deviceStatus:a,deviceStatusName:r,reason:l,desc:c,categoryCode:u}},closeConfirm:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.popVisible=!1},handleSizeChange:function(e){this.configPage({page_number:this.device.page_number,page_size:e}),this.queryDeviceList()},handleCurrentChange:function(e){this.configPage({page_number:e,page_size:this.device.page_size}),this.queryDeviceList()},toDeviceDetail:function(e){var t=e.devId;this.$router.push({name:"deviceInfo",query:{devId:t}})}})},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",{staticClass:"card-view"},[s("el-aside",{staticClass:"statistics",staticStyle:{padding:"0.83333rem 0 0.83333rem 0.83333rem"},attrs:{width:"100%"}},[s("el-row",{attrs:{gutter:0,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[s("div",{staticStyle:{"text-align":"left"}},[s("sensor-filter",{staticClass:"filter-com",attrs:{sensorTypes:e.sensorTypes,sensorStatus:e.sensorStatus},on:{sensorChanged:e.changeSensors,statusChanged:e.ChangeStatus}})],1),e._v(" "),e.device.list&&e.device.list.length>0?s("el-row",{staticClass:"sensor-list"},e._l(e.device.list,function(t,n){return s("el-col",{key:n,attrs:{xs:12,sm:12,md:8,lg:8,xl:6}},[s("sensor-component",{attrs:{params:t},nativeOn:{click:function(s){e.toDeviceDetail(t)}}})],1)})):s("el-row",{staticClass:"sensor-list"},[s("no-data")],1),e._v(" "),s("div",{staticStyle:{margin:"0.83333rem 0","text-align":"right"}},[s("el-pagination",{attrs:{background:"","current-page":e.device.page_number,"page-sizes":[10,20,30,40,50],"page-size":e.device.page_size,layout:"total, sizes, prev, pager, next",total:e.device.total_count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1)},staticRenderFns:[]};var h=s("VU/8")(v,p,!1,function(e){s("PO2F")},"data-v-302057c3",null);t.default=h.exports},"7f8e":function(e,t){},PO2F:function(e,t){},dzN6:function(e,t,s){"use strict";var n={0:{color:"red",label:"待处理"},1:{color:"green",label:"已处理"},2:{color:"green",label:"处理完成"},3:{color:"gray",label:"自动恢复"}},o={name:"alarm-status",props:{status:{type:Object,default:function(){return{code:2,label:"处理完成"}}}},computed:{styleObj:function(){return{display:"inline-block",background:n[this.status.code].color||"green",width:"8px",height:"8px","border-radius":"50%"}},label:function(){return this.status.label}}},i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{style:this.styleObj}),this._v(" "),t("span",[this._v(this._s(this.label))])])},staticRenderFns:[]},a=s("VU/8")(o,i,!1,null,null,null);t.a=a.exports},x45B:function(e,t){}});
//# sourceMappingURL=5.7fb947b23095fe53f6b5.js.map